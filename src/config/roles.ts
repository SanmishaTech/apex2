// RBAC constants: stable permission & role identifiers plus role->permission mapping.
// Extend by adding new PERMISSIONS keys and including them in relevant ROLES_PERMISSIONS entries.
export const PERMISSIONS = {
	// Core / Dashboard
	VIEW_DASHBOARD: 'VIEW:DASHBOARD',

	// Users (existing internal management)
	READ_USERS: 'READ:USERS',
	EDIT_USERS: 'EDIT:USERS',
	DELETE_USERS: 'MANAGE:USERS',

	// Projects
	CREATE_PROJECT: 'CREATE:PROJECT', // create new project (Admin only)
	READ_PROJECT: 'READ:PROJECT', // view project(s)
	EDIT_PROJECT: 'EDIT:PROJECT', // edit project metadata
	DELETE_PROJECT: 'DELETE:PROJECT', // delete project
	MANAGE_PROJECT_USERS: 'MANAGE:PROJECT:USERS', // add/remove users to project

	// Project Files
	UPLOAD_PROJECT_FILE: 'UPLOAD:PROJECT:FILE', // upload / attach file to project
	READ_PROJECT_FILE: 'READ:PROJECT:FILE', // download/view project files
	DELETE_PROJECT_FILE: 'DELETE:PROJECT:FILE', // remove project files
	// Blocks & Cracks
	IMPORT_CRACKS: 'IMPORT:CRACKS', // import crack identifications via Excel
	READ_CRACKS: 'READ:CRACKS',
	MANAGE_BLOCKS: 'MANAGE:BLOCKS',
	// Design Maps
	READ_DESIGN_MAP: 'READ:DESIGN:MAP',
	WRITE_DESIGN_MAP: 'WRITE:DESIGN:MAP',
	// Cities
	READ_CITIES: 'READ:CITIES',
	EDIT_CITIES: 'EDIT:CITIES',
	DELETE_CITIES: 'DELETE:CITIES',
	// State permissions
	READ_STATES: 'READ:STATES',
	EDIT_STATES: 'EDIT:STATES',
	DELETE_STATES: 'DELETE:STATES',
	// Company permissions
	READ_COMPANIES: 'READ:COMPANIES',
	EDIT_COMPANIES: 'EDIT:COMPANIES',
	DELETE_COMPANIES: 'DELETE:COMPANIES',
	// Site permissions
	READ_SITES: 'READ:SITES',
	EDIT_SITES: 'EDIT:SITES',
	DELETE_SITES: 'DELETE:SITES',
	// Department permissions
	READ_DEPARTMENTS: 'READ:DEPARTMENTS',
	EDIT_DEPARTMENTS: 'EDIT:DEPARTMENTS',
	DELETE_DEPARTMENTS: 'DELETE:DEPARTMENTS',
	// Employee permissions
	READ_EMPLOYEES: 'READ:EMPLOYEES',
	EDIT_EMPLOYEES: 'EDIT:EMPLOYEES',
	DELETE_EMPLOYEES: 'DELETE:EMPLOYEES',
	// Manpower Supplier permissions
	READ_MANPOWER_SUPPLIERS: 'READ:MANPOWER:SUPPLIERS',
	EDIT_MANPOWER_SUPPLIERS: 'EDIT:MANPOWER:SUPPLIERS',
	DELETE_MANPOWER_SUPPLIERS: 'DELETE:MANPOWER:SUPPLIERS',
	// Manpower (workers) permissions
	READ_MANPOWER: 'READ:MANPOWER',
	EDIT_MANPOWER: 'EDIT:MANPOWER',
	DELETE_MANPOWER: 'DELETE:MANPOWER',
	// Category permissions
	READ_CATEGORIES: 'READ:CATEGORIES',
	EDIT_CATEGORIES: 'EDIT:CATEGORIES',
	DELETE_CATEGORIES: 'DELETE:CATEGORIES',
	// Skill Set permissions
	READ_SKILLSETS: 'READ:SKILLSETS',
	EDIT_SKILLSETS: 'EDIT:SKILLSETS',
	DELETE_SKILLSETS: 'DELETE:SKILLSETS',
	// Minimum Wages permissions
	READ_MIN_WAGES: 'READ:MIN_WAGES',
	EDIT_MIN_WAGES: 'EDIT:MIN_WAGES',
	DELETE_MIN_WAGES: 'DELETE:MIN_WAGES',
	// Unit permissions
	READ_UNITS: 'READ:UNITS',
	EDIT_UNITS: 'EDIT:UNITS',
	DELETE_UNITS: 'DELETE:UNITS',
	// Item Category permissions
	READ_ITEM_CATEGORIES: 'READ:ITEM:CATEGORIES',
	CREATE_ITEM_CATEGORIES: 'CREATE:ITEM:CATEGORIES',
	EDIT_ITEM_CATEGORIES: 'EDIT:ITEM:CATEGORIES',
	DELETE_ITEM_CATEGORIES: 'DELETE:ITEM:CATEGORIES',
	// Items permissions
	READ_ITEMS: 'READ:ITEMS',
	CREATE_ITEMS: 'CREATE:ITEMS',
	EDIT_ITEMS: 'EDIT:ITEMS',
	DELETE_ITEMS: 'DELETE:ITEMS',
	// Billing Address permissions
	READ_BILLING_ADDRESSES: 'READ:BILLING:ADDRESSES',
	CREATE_BILLING_ADDRESSES: 'CREATE:BILLING:ADDRESSES',
	EDIT_BILLING_ADDRESSES: 'EDIT:BILLING:ADDRESSES',
	DELETE_BILLING_ADDRESSES: 'DELETE:BILLING:ADDRESSES',
	// Vendor permissions
	READ_VENDORS: 'READ:VENDORS',
	CREATE_VENDORS: 'CREATE:VENDORS',
	EDIT_VENDORS: 'EDIT:VENDORS',
	DELETE_VENDORS: 'DELETE:VENDORS',
	// BOQ permissions
	READ_BOQS: 'READ:BOQS',
	EDIT_BOQS: 'EDIT:BOQS',
	DELETE_BOQS: 'DELETE:BOQS',
	// Payment Terms permissions
	READ_PAYMENT_TERMS: 'READ:PAYMENT:TERMS',
	CREATE_PAYMENT_TERMS: 'CREATE:PAYMENT:TERMS',
	EDIT_PAYMENT_TERMS: 'EDIT:PAYMENT:TERMS',
	DELETE_PAYMENT_TERMS: 'DELETE:PAYMENT:TERMS',
	// Cashbook Heads permissions
	READ_CASHBOOK_HEADS: 'READ:CASHBOOK:HEADS',
	EDIT_CASHBOOK_HEADS: 'EDIT:CASHBOOK:HEADS',
	DELETE_CASHBOOK_HEADS: 'DELETE:CASHBOOK:HEADS',
	// Cashbook Budgets permissions
	READ_CASHBOOK_BUDGETS: 'READ:CASHBOOK:BUDGETS',
	CREATE_CASHBOOK_BUDGETS: 'CREATE:CASHBOOK:BUDGETS',
	EDIT_CASHBOOK_BUDGETS: 'EDIT:CASHBOOK:BUDGETS',
	DELETE_CASHBOOK_BUDGETS: 'DELETE:CASHBOOK:BUDGETS',
} as const;

export const ROLES = {
	ADMIN: 'admin', // full system access
	USER: 'user', // internal staff (can see dashboard, read projects/users, but not create projects or upload files)
	PROJECT_USER: 'project_user', // external / client user tied to specific projects (can only read its own project + files)
} as const;

export const ROLES_PERMISSIONS = {
	// Admin: everything
	[ROLES.ADMIN]: [...Object.values(PERMISSIONS)],
	// Internal staff user: can view dashboard, read users & projects & project files (but no creation/upload/delete)
	[ROLES.USER]: [
		PERMISSIONS.VIEW_DASHBOARD,
		PERMISSIONS.READ_USERS,
		PERMISSIONS.READ_PROJECT,
		PERMISSIONS.READ_PROJECT_FILE,
		PERMISSIONS.READ_CRACKS,
		PERMISSIONS.READ_DESIGN_MAP,
		PERMISSIONS.READ_CITIES,
		PERMISSIONS.READ_STATES,
		PERMISSIONS.READ_COMPANIES,
		PERMISSIONS.READ_SITES,
		PERMISSIONS.READ_DEPARTMENTS,
		PERMISSIONS.READ_EMPLOYEES,
		PERMISSIONS.READ_MANPOWER_SUPPLIERS,
		PERMISSIONS.READ_MANPOWER,
		PERMISSIONS.READ_CATEGORIES,
		PERMISSIONS.READ_SKILLSETS,
		PERMISSIONS.READ_MIN_WAGES,
		PERMISSIONS.READ_UNITS,
		PERMISSIONS.READ_ITEM_CATEGORIES,
		PERMISSIONS.READ_ITEMS,
		PERMISSIONS.READ_BILLING_ADDRESSES,
		PERMISSIONS.READ_VENDORS,
		PERMISSIONS.READ_BOQS,
		PERMISSIONS.READ_PAYMENT_TERMS,
		PERMISSIONS.READ_CASHBOOK_HEADS,
		PERMISSIONS.READ_CASHBOOK_BUDGETS,
	],
	// Project (client) user: minimal â€“ only read project + its files (no dashboard access if you prefer; remove if needed)
	[ROLES.PROJECT_USER]: [
		PERMISSIONS.VIEW_DASHBOARD,
		PERMISSIONS.READ_PROJECT,
		PERMISSIONS.READ_PROJECT_FILE,
		PERMISSIONS.READ_CRACKS,
		PERMISSIONS.READ_DESIGN_MAP,
		PERMISSIONS.READ_CITIES,
		PERMISSIONS.READ_STATES,
		PERMISSIONS.READ_COMPANIES,
		PERMISSIONS.READ_SITES,
		PERMISSIONS.READ_DEPARTMENTS,
		PERMISSIONS.READ_EMPLOYEES,
		PERMISSIONS.READ_MANPOWER_SUPPLIERS,
		PERMISSIONS.READ_MANPOWER,
		PERMISSIONS.READ_CATEGORIES,
		PERMISSIONS.READ_SKILLSETS,
		PERMISSIONS.READ_MIN_WAGES,
		PERMISSIONS.READ_UNITS,
		PERMISSIONS.READ_ITEM_CATEGORIES,
		PERMISSIONS.READ_ITEMS,
		PERMISSIONS.READ_BILLING_ADDRESSES,
		PERMISSIONS.READ_VENDORS,
		PERMISSIONS.READ_BOQS,
		PERMISSIONS.READ_PAYMENT_TERMS,
		PERMISSIONS.READ_CASHBOOK_HEADS,
		PERMISSIONS.READ_CASHBOOK_BUDGETS,
	],
} as const;

// NOTE:
// - Only ADMIN retains CREATE/UPDATE/DELETE project, MANAGE_PROJECT_USERS, and file upload/delete.
// - Authorization enforcement for "its own project" must be done at the resolver/service layer:
//   1) Check the user has READ_PROJECT / READ_PROJECT_FILE.
//   2) Verify membership via ProjectUser join before returning restricted data.
// - You may expose helper guards to combine permission + membership check.
